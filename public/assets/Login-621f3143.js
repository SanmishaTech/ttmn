import{a as I,u as j,r as f,j as A,l as o,k as w,J as E}from"./main-56e33d04.js";import{g as D,b as k,s as U,d as q,c as F,q as R,w as B,a as O}from"./Firebase-72b68b0f.js";import{z as v,u as P,t as z}from"./zod-33111011.js";/*! js-cookie v3.0.5 | MIT */function x(r){for(var c=1;c<arguments.length;c++){var u=arguments[c];for(var p in u)r[p]=u[p]}return r}var J={read:function(r){return r[0]==='"'&&(r=r.slice(1,-1)),r.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(r){return encodeURIComponent(r).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function y(r,c){function u(e,l,s){if(!(typeof document>"u")){s=x({},c,s),typeof s.expires=="number"&&(s.expires=new Date(Date.now()+s.expires*864e5)),s.expires&&(s.expires=s.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var t="";for(var a in s)s[a]&&(t+="; "+a,s[a]!==!0&&(t+="="+s[a].split(";")[0]));return document.cookie=e+"="+r.write(l,e)+t}}function p(e){if(!(typeof document>"u"||arguments.length&&!e)){for(var l=document.cookie?document.cookie.split("; "):[],s={},t=0;t<l.length;t++){var a=l[t].split("="),S=a.slice(1).join("=");try{var m=decodeURIComponent(a[0]);if(s[m]=r.read(S,m),e===m)break}catch{}}return e?s[e]:s}}return Object.create({set:u,get:p,remove:function(e,l){u(e,"",x({},l,{expires:-1}))},withAttributes:function(e){return y(this.converter,x({},this.attributes,e))},withConverter:function(e){return y(x({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(c)},converter:{value:Object.freeze(r)}})}var L=y(J,{path:"/"});const M=v.object({email:v.string().email("Invalid email address").min(1,"Email is required"),password:v.string().min(6,"Password is required"),isAdmin:v.any().optional()}),K=()=>{I(),j(n=>n.themeConfig.theme==="dark"||n.themeConfig.isDarkMode);const[r,c]=f.useState(!1);f.useState(""),f.useState(""),f.useState(!1),f.useState("");const[u,p]=f.useState(),e=A(),l=D(k),s=async n=>{U(q,n.email,n.password).then(async d=>{const i=d.user;console.log(i);const h=F(l,"users"),N=R(h,B("email","==",i.email));try{(await O(N)).forEach(g=>{console.log(g.data()),p(g.data()),L.set("user",JSON.stringify({email:g.data().email,role:g.data().role,username:g.data().username,uid:g.id}),{expires:7}),i.role==="admin"?e("/services"):e("/dashboard")})}catch(C){console.error("Error fetching user data:",C),E.error("Emial or password is incorrect")}}).catch(d=>{const i=d.code,h=d.message;console.log(i,h),E.error("Emial or password is incorrect")})},{register:t,handleSubmit:a,watch:S,formState:{errors:m}}=P({resolver:z(M)});function b(n){return n.toString().split("").map(Number).reduce((d,i)=>d+i,0)}return o("div",{className:"max-h-[100vh] flex justify-center items-center bg-cover bg-center bg-[url('/assets/images/map.svg')] dark:bg-[url('/assets/images/map-dark.svg')]",children:o("div",{className:"flex flex-col items-center justify-center h-full mt-[100px]",children:w("div",{className:" panel sm:w-[450px] min-h-[400px] m-6 max-w-lg w-full",children:[o("h2",{className:"font-bold text-2xl mb-3",children:"Sign In"}),o("p",{className:"mb-7",children:"Enter your email and password to login"}),w("form",{className:"space-y-5",onSubmit:a(n=>{console.log(n.isAdmin),n.isAdmin=S("isAdmin")===!0,c(n.isAdmin||!1),console.log(n),console.log("BOOLonSUbmt",r);const d="12-12-2022",i=new Date(d);console.log(i.getDate());const h=b(i.getDate());console.log(h),s(n)}),children:[w("div",{children:[o("label",{htmlFor:"email",children:"Email"}),o("input",{id:"email",type:"email",...t("email"),className:"form-input",placeholder:"Enter Email"}),m.email&&o("span",{className:"text-red-600",children:m.email.message})]}),w("div",{children:[o("label",{htmlFor:"password",children:"Password"}),o("input",{id:"password",type:"password",...t("password"),className:"form-input",placeholder:"Enter Password"}),m.password&&o("span",{className:"text-red-600",children:m.password.message})]}),o("button",{type:"submit",className:"btn btn-primary w-full",children:"SIGN IN"})]})]})})})};export{K as default};
